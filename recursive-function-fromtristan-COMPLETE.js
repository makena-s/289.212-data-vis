// COMPLETE VERSION OF COUNTFAMILIES FUNCTION

beetledata = {

    "order-Coleoptera": {
        "suborder-Protocoleoptera": {
            "infraorder-None1": {
                "clade-None1": {
                    "superfamily-Tshekardocoleoidea": ["Tshekardocoleidae", "Labradorocoleidae", "Oborocoleidae"],
                    "superfamily-Permocupedoidea": ["Permocupedidae", "Taldycupedida", "Ademosynidae", "Permosynidae"]
                }
            }
        },
        "suborder-Archostemata": {
            "infraorder-None2": {
                "clade-None2": {
                    "superfamily-None1": ["Crowsoniellidae", "Cupedidae", "Micromalthidae", "Ommatidae", "Jurodidae", "Triadocupedidae", "Magnocoleidae", "Obrieniidae"]
                }
            }
        },
        "suborder-Myxophaga": {
            "infraorder-None3": {
                "clade-None3": {
                    "superfamily-Asiocoleoidea": ["Asiocoleidae", "Tricoleidae"],
                    "superfamily-Rhombocoleoidea": ["Rhombocoleidae"],
                    "superfamily-Schizophoroidea": ["Schizophoridae", "Catiniidae", "Schizocoleidae"],
                    "superfamily-Lepiceroidea": ["Lepiceridae"],
                    "superfamily-Sphaeriusoidea": ["Torridincolidae", "Hydroscaphidae", "Sphaeriusidae"],
                }
            }
        },
        "suborder-Adephaga": {
            "infraorder-None4": {
                "clade-None4": {
                    "superfamily-None2": ["Tritarsidae", "Gyrinidae", "Trachypachidae", "Rhysodidae", "Carabidae", "Haliplidae", "Triaplidae", "Colymbotethidae", "Parahygrobiidae", "Coptoclavidae", "Liadytidae", "Meruidae", "Noteridae", "Amphizoidae", "Aspidytidae", "Hygrobiidae", "Dytiscidae"]
                }
            }
        },
        "suborder-Polyphaga": {
            "infraorder-Staphyliniformia": {
                "clade-None5": {
                    "superfamily-Hydrophiloidea": ["Hydrophilidae", "Sphaeritidae", "Synteliidae", "Histeridae"],
                    "superfamily-Staphylinoidea": ["Hydraenidae", "Ptiliidae", "Agyrtidae", "Leiodidae", "Silphidae", "Staphylinidae"]
                }
            },
            "infraorder-Scarabaeiformia": {
                "clade-None6": {
                    "superfamily-Scarabaeoidea": ["Pleocomidae", "Geotrupidae", "Belohinidae", "Passalidae", "Trogidae", "Glaresidae", "Diphyllostomatidae", "Lucanidae", "Ochodaeidae", "Hybosoridae", "Glaphyridae", "Scarabaeidae", "Coprinisphaeridae", "Pallichnidae"],
                }
            },
            "infraorder-Elateriformia": {
                "clade-None7": {
                    "superfamily-Scirtoidea": ["Decliniidae", "Eucinetidae", "Clambidae", "Scirtidae", "Elodophthalmidae", "Mesocinetidae"],
                    "superfamily-Dascilloidea": ["Dascillidae", "Rhipiceridae"],
                    "superfamily-Buprestoidea": ["Schizopodidae", "Buprestidae"],
                    "superfamily-Byrrhoidea": ["Byrrhidae", "Elmidae", "Dryopidae", "Lutrochidae", "Limnichidae", "Heteroceridae", "Psephenidae", "Cneoglossidae", "Ptilodactylidae", "Podabrocephalidae", "Chelonariidae", "Eulichadidae", "Callirhipidae"],
                    "superfamily-Elateroidea": ["Artematopodidae", "Brachypsectridae", "Cantharidae", "Cerophytidae", "Elateridae", "Eucnemidae", "Lampyridae", "Lycidae", "Omethidae", "Phengodidae", "Rhagophthalmidae", "Sinopyrophoridae", "Throscidae", "Berendtimiridae", "Praelateriidae"],
                    "superfamily-Rhinorhipoidea": ["Rhinorhipidae"]
                }
            },
            "infraorder-Bostrichiformia": {
                "clade-None8": {
                    "superfamily-Derodontoidea": ["Derodontidae", "Nosodendridae", "Jacobsoniidae"],
                    "superfamily-Bostrichoidea": ["Dermestidae", "Endecatomidae", "Bostrichidae", "Ptinidae"]
                }
            },
            "infraorder-Cucujiformia": {
                "clade-None9": {
                    "superfamily-Lymexyloidea": ["Lymexylidae"],
                    "superfamily-Cleroidea": ["Phloiophilidae", "Trogossitidae", "Chaetosomatidae", "Metaxinidae", "Thanerocleridae", "Cleridae", "Acanthocnemidae", "Phycosecidae", "Prionoceridae", "Mauroniscidae", "Melyridae"],
                    "superfamily-Cucujoidea": ["Parandrexidae", "Sinisilvanidae", "Boganiidae", "Byturidae", "Helotidae", "Protocucujidae", "Sphindidae", "Biphyllidae", "Erotylidae", "Monotomidae", "Hobartiidae", "Cryptophagidae", "Agapythidae", "Priasilphidae", "Phloeostichidae", "Silvanidae", "Cucujidae", "Myraboliidae", "Cavognathidae", "Lamingtoniidae", "Passandridae", "Phalacridae", "Propalticidae", "Laemophloeidae", "Tasmosalpingidae", "Cyclaxyridae", "Kateretidae", "Nitidulidae", "Smicripidae", "Bothrideridae", "Cerylonidae", "Alexiidae", "Discolomatidae", "Endomychidae", "Coccinellidae", "Corylophidae", "Akalyptoischiidae", "Latridiidae"],
                    "superfamily-Tenebrionoidea": ["Mycetophagidae", "Archeocrypticidae", "Pterogeniidae", "Ciidae", "Tetratomidae", "Melandryidae", "Mordellidae", "Ripiphoridae", "Zopheridae", "Ulodidae", "Promecheilidae", "Chalcodryidae", "Trachelostenidae", "Tenebrionidae", "Prostomidae", "Synchroidae", "Stenotrachelidae", "Oedemeridae", "Meloidae", "Mycteridae", "Boridae", "Trictenotomidae", "Pythidae", "Pyrochroidae", "Salpingidae", "Anthicidae", "Aderidae", "Scraptiidae"]
                },
                "clade-Phytophaga": {
                    "superfamily-Chrysomeloidea": ["Oxypeltidae", "Vesperidae", "Disteniidae", "Cerambycidae", "Megalopodidae", "Orsodacnidae", "Chrysomelidae"],
                    "superfamily-Curculionoidea": ["Nemonychidae", "Anthribidae", "Ulyanidae", "Belidae", "Caridae", "Attelabidae", "Brentidae", "Dryophthoridae", "Brachyceridae", "Curculionidae"]
                }
            }
        }
    }

}

// renamed all duplicates to be unique: clade-None1

function countFamilies(group, totalcount) {
    result = totalcount;
    
    Object.keys(beetledata["order-Coleoptera"]).forEach(suborderkey => {
        // check suborders
        if (suborderkey == group) {
            Object.keys(beetledata["order-Coleoptera"][suborderkey]).forEach(infrakey => {
                countFamilies(infrakey, result)
                console.log("RESULT: " + result)
            });
        } else {
            Object.keys(beetledata["order-Coleoptera"][suborderkey]).forEach(infrakey => {
                // check infraorders
                if (infrakey == group) {
                    Object.keys(beetledata["order-Coleoptera"][suborderkey][infrakey]).forEach(cladekey => {
                        countFamilies(cladekey, result)
                    });
                } else {
                    Object.keys(beetledata["order-Coleoptera"][suborderkey][infrakey]).forEach(cladekey => {
                        // check clades
                        if (cladekey == group) {
                            Object.keys(beetledata["order-Coleoptera"][suborderkey][infrakey][cladekey]).forEach(superfamkey => {
                                countFamilies(superfamkey, result)
                            });
                        } else {
                            Object.keys(beetledata["order-Coleoptera"][suborderkey][infrakey][cladekey]).forEach(superfamkey => {
                                // check superfamilies
                                if (superfamkey == group) {
                                    beetledata["order-Coleoptera"][suborderkey][infrakey][cladekey][superfamkey].forEach(family => {
                                        //console.log('family: ' + family);
                                        document.write(family + '<br />');
                                        result += 1;
                                    });
                                }
                            });
                        }
                    });
                }
            });
        }
    });
    return result;
};

document.write(countFamilies('superfamily-Tshekardocoleoidea',0));

document.write(" ----- " + "<br>")

//document.write(countFamilies('clade-None1',0));

//document.write(countFamilies('infraorder-None1',0));

//document.write(countFamilies('infraorder-Elateriformia',0));

//document.write(countFamilies('suborder-Archostemata',0));

document.write(countFamilies('suborder-Polyphaga',0));

// ------- it all works now :^) ------------------------------

//document.write(countFamilies('clade-Phytophaga', 0)); // correct 17
//document.write(countFamilies('clade-None9', 0)); // correct 78
//document.write(countFamilies('clade-None8', 0)); // correct 7
//document.write(countFamilies('clade-None7', 0)); // correct 39
//document.write(countFamilies('clade-None6', 0)); // correct 14
//document.write(countFamilies('clade-None5', 0)); // correct 10

document.write(" ----- " + "<br>")

//document.write(countFamilies('infraorder-Staphyliniformia', 0)); // correct 10
//document.write(countFamilies('infraorder-Scarabaeiformia', 0)); // correct 14
//document.write(countFamilies('infraorder-Elateriformia', 0)); // correct 39
//document.write(countFamilies('infraorder-Bostrichiformia', 0)); // correct 38
//document.write(countFamilies('infraorder-Cucujiformia', 0)); // correct 14



